<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ChatOps ‚Ä¢ Preemptive Movement</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --red:#e53e3e;--red-dark:#9b2c2c;
  --bg:#050810;--bg2:#0d1117;--bg3:#161b27;
  --border:rgba(255,255,255,0.07);
  --text:#f0f4ff;--muted:#4a5568;--muted2:#718096;
}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(229,62,62,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(229,62,62,0.03) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0}

/* LEGAL */
#legal-overlay{position:fixed;inset:0;background:rgba(5,8,16,0.98);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;overflow-y:auto}
.legal-modal{background:var(--bg2);border:1px solid rgba(229,62,62,0.25);border-radius:24px;padding:32px 24px;max-width:420px;width:100%;text-align:center}
.legal-modal .warn{font-size:40px;display:block;margin-bottom:16px}
.legal-modal h2{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:2px;margin-bottom:8px}
.age-badge{display:inline-block;background:var(--red);color:#fff;font-family:'Bebas Neue',sans-serif;font-size:16px;letter-spacing:2px;padding:3px 14px;border-radius:999px;margin-bottom:18px}
.legal-text{font-size:11px;color:var(--muted2);line-height:1.8;text-align:left;background:rgba(0,0,0,0.3);border:1px solid var(--border);border-radius:12px;padding:14px 16px;margin-bottom:18px}
.legal-text b{color:#e2e8f0}
.legal-text p{margin-bottom:8px}
.legal-text p:last-child{margin-bottom:0}
.check-row{display:flex;align-items:flex-start;gap:12px;text-align:left;background:rgba(229,62,62,0.05);border:1px solid rgba(229,62,62,0.15);border-radius:12px;padding:14px;margin-bottom:20px}
.check-row input[type=checkbox]{width:20px;height:20px;min-width:20px;accent-color:var(--red);cursor:pointer;margin-top:1px}
.check-row label{font-size:11px;color:#cbd5e0;line-height:1.6;cursor:pointer}
#btn-accept{width:100%;padding:16px;border:none;border-radius:14px;font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:3px;transition:all 0.2s;background:#2d3748;color:#718096;cursor:not-allowed}
#btn-accept.activo{background:var(--red);color:#fff;cursor:pointer;box-shadow:0 4px 20px rgba(229,62,62,0.4)}
#btn-accept.activo:hover{transform:translateY(-2px)}

/* APP */
.wrap{max-width:480px;margin:0 auto;padding:28px 20px 120px;position:relative;z-index:1}
header{display:flex;align-items:center;justify-content:space-between;margin-bottom:40px;padding-bottom:24px;border-bottom:1px solid var(--border)}
.logo-area{display:flex;align-items:center;gap:12px}
.logo-icon{background:var(--red);width:42px;height:42px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;box-shadow:0 0 20px rgba(229,62,62,0.4)}
.logo-text h1{font-family:'Bebas Neue',sans-serif;font-size:26px;letter-spacing:2px;line-height:1;color:#fff}
.logo-text span{font-size:8px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:3px}
.status-pill{display:flex;align-items:center;gap:6px;background:var(--bg3);border:1px solid var(--border);border-radius:999px;padding:6px 12px}
.dot{width:6px;height:6px;background:#48bb78;border-radius:50%;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(.8)}}
.status-pill span:last-child{font-size:9px;font-weight:700;color:var(--muted2);text-transform:uppercase;letter-spacing:2px}
.hero-title{font-family:'Bebas Neue',sans-serif;font-size:52px;line-height:.9;letter-spacing:1px;margin-bottom:8px}
.hero-title .accent{color:var(--red)}
.hero-sub{font-size:10px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:4px;margin-bottom:32px}
textarea{width:100%;height:220px;background:var(--bg2);border:2px solid rgba(255,255,255,0.06);border-radius:24px;padding:24px;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:12px;line-height:1.7;resize:none;outline:none;transition:border-color 0.2s;margin-bottom:16px}
textarea::placeholder{color:var(--muted)}
textarea:focus{border-color:var(--red)}
.ctx-row{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:24px}
.ctx-btn{padding:8px 18px;border-radius:999px;border:1px solid rgba(255,255,255,0.1);background:transparent;color:var(--muted2);font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:2px;cursor:pointer;transition:all 0.2s;font-family:'DM Sans',sans-serif}
.ctx-btn:hover{border-color:rgba(255,255,255,0.2);color:#fff}
.ctx-btn.active{background:#fff;color:#000;border-color:#fff;transform:scale(1.05)}
.btn-analyze{width:100%;padding:22px;background:var(--red);border:none;border-radius:24px;color:#fff;font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:12px;transition:all 0.2s;border-bottom:4px solid var(--red-dark);box-shadow:0 8px 32px rgba(229,62,62,0.3);margin-bottom:16px}
.btn-analyze:hover{transform:translateY(-2px)}
.btn-analyze:active{transform:translateY(2px);border-bottom-width:0}
.credits-box{background:rgba(255,255,255,0.02);border:1px solid var(--border);border-radius:16px;padding:14px;text-align:center;font-size:10px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:2px}
.credit-num{color:var(--red);font-size:14px}
.section{display:none}
.section.visible{display:block}
#loader-section{text-align:center;padding:60px 0}
.spinner{width:80px;height:80px;border:2px solid var(--border);border-top-color:var(--red);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 24px}
@keyframes spin{to{transform:rotate(360deg)}}
#loader-section p{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--muted2);text-transform:uppercase;letter-spacing:3px;animation:blink 1.2s steps(1) infinite}
@keyframes blink{50%{opacity:.3}}
.back-btn{display:flex;align-items:center;gap:8px;background:none;border:none;color:var(--muted);font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:3px;cursor:pointer;margin-bottom:24px;transition:color 0.2s;font-family:'DM Sans',sans-serif}
.back-btn:hover{color:#fff}
.card{background:var(--bg2);border:1px solid var(--border);border-radius:24px;padding:28px;margin-bottom:16px}
.card-label{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:3px;margin-bottom:10px;display:block}
.lbl-red{color:var(--red)}.lbl-yellow{color:#f6c90e}.lbl-blue{color:#63b3ed}
.intention-text{font-family:'Bebas Neue',sans-serif;font-size:32px;line-height:1;letter-spacing:1px}
.metrics-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}
.metric-card{background:var(--bg2);border:1px solid var(--border);border-radius:20px;padding:24px;text-align:center}
.metric-label{font-size:9px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:2px;margin-bottom:8px;display:block}
.metric-value{font-family:'Bebas Neue',sans-serif;font-size:42px;line-height:1}
.col-green{color:#68d391}.col-yellow{color:#f6c90e}.col-red{color:var(--red)}
.action-text{font-style:italic;font-size:16px;line-height:1.6;color:#e2e8f0}
.msg-box{background:rgba(229,62,62,0.04);border:1px solid rgba(229,62,62,0.15);border-radius:24px;padding:28px;margin-bottom:16px}
.msg-content{background:rgba(0,0,0,0.4);border:1px solid var(--border);border-radius:14px;padding:20px;font-family:'JetBrains Mono',monospace;font-size:12px;line-height:1.8;color:#e2e8f0;margin-bottom:16px;user-select:all}
.btn-copy{width:100%;padding:18px;background:var(--red);border:none;border-radius:16px;color:#fff;font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:3px;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all 0.2s;box-shadow:0 4px 20px rgba(229,62,62,0.3)}
.btn-copy:hover{transform:translateY(-1px)}
.upgrade-card{background:linear-gradient(135deg,rgba(229,62,62,0.08),rgba(229,62,62,0.02));border:1px solid rgba(229,62,62,0.2);border-radius:28px;padding:36px 28px;text-align:center;margin-bottom:16px}
.upgrade-card h3{font-family:'Bebas Neue',sans-serif;font-size:26px;letter-spacing:2px;margin-bottom:10px}
.upgrade-card p{font-size:12px;color:var(--muted2);line-height:1.6;margin-bottom:20px;max-width:280px;margin-left:auto;margin-right:auto}
.features{list-style:none;text-align:left;margin-bottom:24px;display:flex;flex-direction:column;gap:10px}
.features li{font-size:12px;color:#cbd5e0;display:flex;align-items:center;gap:10px}
.features li::before{content:'‚Üí';color:var(--red);font-weight:700}
.btn-cta{width:100%;padding:16px;border:none;border-radius:14px;font-family:'Bebas Neue',sans-serif;font-size:17px;letter-spacing:2px;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all 0.2s;margin-bottom:10px}
.btn-cta:last-child{margin-bottom:0}
.btn-cta:hover{transform:translateY(-1px)}
.cta-white{background:#fff;color:#000;box-shadow:0 4px 20px rgba(255,255,255,0.1)}
.cta-dark{background:#1a1a2e;color:#fff;border:1px solid rgba(255,255,255,0.15)}
.cooldown-card{background:var(--bg2);border:1px solid var(--border);border-radius:28px;padding:40px 28px;text-align:center;margin-bottom:16px}
.cooldown-card h3{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:2px;margin-bottom:12px}
.cooldown-card p{font-size:12px;color:var(--muted2);line-height:1.7;margin-bottom:16px}
.timer{font-family:'JetBrains Mono',monospace;font-size:36px;color:var(--red);margin:0 0 24px;letter-spacing:4px}
footer{position:fixed;bottom:0;left:0;width:100%;padding:14px;text-align:center;font-size:9px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:3px;background:rgba(5,8,16,0.95);border-top:1px solid var(--border);backdrop-filter:blur(8px);z-index:100}
</style>
</head>
<body>

<!-- ===== AVISO LEGAL ===== -->
<div id="legal-overlay">
  <div class="legal-modal">
    <span class="warn">‚ö†Ô∏è</span>
    <h2>Aviso Legal</h2>
    <span class="age-badge">+18 A√ëOS</span>
    <div class="legal-text">
      <p><b>Esta herramienta es una gu√≠a orientativa de comunicaci√≥n personal</b> creada por Antonio (Preemptive Movement). No sustituye en ning√∫n caso el consejo de un profesional de la salud mental, psic√≥logo, psiquiatra, m√©dico o cualquier otro especialista.</p>
      <p>El autor <b>no es m√©dico, psic√≥logo, terapeuta ni profesional sanitario</b>. Los an√°lisis son de car√°cter orientativo y no constituyen diagn√≥stico, tratamiento ni prescripci√≥n de ning√∫n tipo.</p>
      <p>Si est√°s atravesando una situaci√≥n de crisis emocional o problema de salud mental, <b>consulta con un profesional cualificado</b>.</p>
      <p>El uso est√° reservado a personas <b>mayores de 18 a√±os</b>.</p>
    </div>
    <div class="check-row">
      <input type="checkbox" id="legal-check">
      <label for="legal-check">He le√≠do y acepto el aviso legal. Confirmo que tengo 18 a√±os o m√°s y entiendo que esto no es asesoramiento m√©dico ni psicol√≥gico.</label>
    </div>
    <button id="btn-accept">ENTRAR ‚Üí</button>
  </div>
</div>

<!-- ===== APP ===== -->
<div class="wrap">
  <header>
    <div class="logo-area">
      <div class="logo-icon">‚ö°</div>
      <div class="logo-text">
        <h1>ChatOps</h1>
        <span>Preemptive Movement</span>
      </div>
    </div>
    <div class="status-pill">
      <div class="dot"></div>
      <span>Online</span>
    </div>
  </header>

  <!-- INPUT -->
  <div id="input-section" class="section visible">
    <h2 class="hero-title">Descifra la <span class="accent">intenci√≥n.</span></h2>
    <p class="hero-sub">Diagn√≥stico t√°ctico de conversaciones</p>
    <textarea id="chat-input" placeholder="Pega aqu√≠ el hilo de mensajes que quieres analizar..."></textarea>
    <div class="ctx-row" id="ctx-row">
      <button class="ctx-btn active" data-ctx="pareja">Pareja</button>
      <button class="ctx-btn" data-ctx="cita">Cita</button>
      <button class="ctx-btn" data-ctx="trabajo">Trabajo</button>
      <button class="ctx-btn" data-ctx="negociacion">Negociaci√≥n</button>
    </div>
    <button class="btn-analyze" id="btn-analyze">‚ö° ANALIZAR</button>
    <div class="credits-box">
      An√°lisis gratuitos disponibles: <span class="credit-num" id="credit-display">2</span> de 2
    </div>
  </div>

  <!-- LOADER -->
  <div id="loader-section" class="section">
    <div class="spinner"></div>
    <p>Procesando se√±ales...</p>
  </div>

  <!-- RESULTADO -->
  <div id="result-section" class="section">
    <button class="back-btn" id="btn-back">‚Üê Nueva evaluaci√≥n</button>
    <div class="card" style="border-left:3px solid var(--red)">
      <span class="card-label lbl-red">‚¨§ Intenci√≥n detectada</span>
      <div class="intention-text" id="res-intention">‚Äì</div>
    </div>
    <div class="metrics-grid">
      <div class="metric-card">
        <span class="metric-label">Inter√©s</span>
        <div class="metric-value col-green" id="res-interest">‚Äì</div>
      </div>
      <div class="metric-card">
        <span class="metric-label">Riesgo</span>
        <div class="metric-value" id="res-risk">‚Äì</div>
      </div>
    </div>
    <div class="card">
      <span class="card-label lbl-yellow">‚óÜ Qu√© hacer ahora</span>
      <p class="action-text" id="res-action">‚Äì</p>
    </div>
    <div class="msg-box">
      <span class="card-label lbl-blue">‚ú¶ Respuesta recomendada</span>
      <div class="msg-content" id="res-msg">‚Äì</div>
      <button class="btn-copy" id="btn-copy">üìã COPIAR RESPUESTA</button>
    </div>
    <div class="upgrade-card">
      <span style="font-size:36px;display:block;margin-bottom:16px">üîê</span>
      <h3>¬øQuieres resultados reales?</h3>
      <p>Este an√°lisis es una muestra de lo que hacemos con personas reales. Con asesor√≠a 1:1 trabajamos tu caso con estrategia personalizada.</p>
      <ul class="features">
        <li>An√°lisis ilimitados y personalizados</li>
        <li>Estrategia de conversaci√≥n dise√±ada para ti</li>
        <li>Sesiones 1:1 con Antonio</li>
        <li>Acceso a recursos exclusivos</li>
      </ul>
      <button class="btn-cta cta-white" id="cta-wa1">üì≤ WhatsApp ¬∑ 672 680 535</button>
      <button class="btn-cta cta-dark" id="cta-mail1">‚úâÔ∏è preemptivemovement@gmail.com</button>
      <button class="btn-cta cta-dark" id="cta-blog1">üåê preemptivemovement.blogspot.com</button>
    </div>
  </div>

  <!-- COOLDOWN -->
  <div id="cooldown-section" class="section">
    <div class="cooldown-card">
      <span style="font-size:48px;display:block;margin-bottom:16px">‚è±</span>
      <h3>L√≠mite alcanzado</h3>
      <p>Has agotado los 2 an√°lisis gratuitos. El sistema se recargar√° en:</p>
      <div class="timer" id="timer-display">60:00</div>
      <p>O contacta directamente con Antonio para an√°lisis ilimitados y asesor√≠a personalizada.</p>
    </div>
    <div class="upgrade-card">
      <button class="btn-cta cta-white" id="cta-wa2">üì≤ WhatsApp ¬∑ 672 680 535</button>
      <button class="btn-cta cta-dark" id="cta-mail2">‚úâÔ∏è preemptivemovement@gmail.com</button>
      <button class="btn-cta cta-dark" id="cta-blog2">üåê preemptivemovement.blogspot.com</button>
    </div>
  </div>
</div>

<footer>Preemptive Movement ¬∑ Sin conexi√≥n a servidores ¬∑ Datos 100% privados</footer>

<script>
(function() {

// ===== LEGAL =====
var overlay = document.getElementById('legal-overlay');
var cbLegal = document.getElementById('legal-check');
var btnAccept = document.getElementById('btn-accept');

cbLegal.addEventListener('change', function() {
  if (this.checked) {
    btnAccept.classList.add('activo');
  } else {
    btnAccept.classList.remove('activo');
  }
});

btnAccept.addEventListener('click', function() {
  if (!cbLegal.checked) {
    alert('Marca la casilla para confirmar que aceptas el aviso legal.');
    return;
  }
  overlay.style.display = 'none';
});

// ===== RESPUESTAS =====
var RESPONSES = {
  pareja: [
    { intention: "Busca atenci√≥n y validaci√≥n emocional", interest: 78, risk: "Medio", riskCol: "col-yellow",
      action: "Mant√©n la calma y no reacciones de inmediato. Esta persona responde al estado emocional que proyectas, no a tus palabras.",
      msg: "Entiendo lo que me dices. Necesito algo de tiempo para procesar esto y darte la respuesta que merece." },
    { intention: "Pone a prueba tu reacci√≥n antes de comprometerse", interest: 85, risk: "Bajo", riskCol: "col-green",
      action: "No demuestres ansiedad. La persona observa si mantienes el frame. Responde desde la seguridad, no desde la necesidad.",
      msg: "Me alegra que lo digas. Cuando quieras quedar y hablar tranquilamente, d√≠melo." }
  ],
  cita: [
    { intention: "Inter√©s real pero inseguridad para dar el siguiente paso", interest: 72, risk: "Bajo", riskCol: "col-green",
      action: "Prop√≥n un plan concreto, no una invitaci√≥n abierta. La ambig√ºedad mata el inter√©s. S√© espec√≠fico con d√≠a, hora y lugar.",
      msg: "Este s√°bado a las 8. ¬øTe viene bien o prefieres el domingo?" },
    { intention: "Mantiene opciones abiertas, t√∫ eres la opci√≥n B", interest: 51, risk: "Medio", riskCol: "col-yellow",
      action: "Reduce tu disponibilidad. Si siempre est√°s accesible, no generas deseo. Hazte escaso estrat√©gicamente esta semana.",
      msg: "Esta semana tengo agenda apretada. La pr√≥xima podemos cuadrar algo." }
  ],
  trabajo: [
    { intention: "Busca establecer jerarqu√≠a desde el inicio", interest: 60, risk: "Medio", riskCol: "col-yellow",
      action: "No cedas terreno en la primera interacci√≥n. El tono que establezcas ahora determinar√° toda la relaci√≥n laboral futura.",
      msg: "Perfecto, lo reviso y te doy feedback antes del viernes. ¬øTe parece bien as√≠?" },
    { intention: "Reconocimiento indirecto de tu valor", interest: 80, risk: "Bajo", riskCol: "col-green",
      action: "Este es el momento para negociar. No lo dejes pasar. El apalancamiento ahora lo tienes t√∫.",
      msg: "Me alegra que lo values. Justo quer√≠a hablar contigo sobre mis condiciones esta semana." }
  ],
  negociacion: [
    { intention: "T√©cnica de presi√≥n por urgencia artificial", interest: 65, risk: "Medio", riskCol: "col-yellow",
      action: "No te dejes llevar por la urgencia que imponen. Quien necesita cerrar r√°pido tiene menos poder del que aparenta.",
      msg: "Entiendo la urgencia de tu parte. Yo necesito 48h m√°s para revisar los t√©rminos con calma." },
    { intention: "Posici√≥n de entrada, esperan ser rebatidos", interest: 75, risk: "Bajo", riskCol: "col-green",
      action: "Esta es solo su primera oferta. Si aceptas ahora, dejas dinero sobre la mesa. Contraofer con seguridad.",
      msg: "Aprecio la propuesta. Mi posici√≥n es diferente. Estoy seguro de que podemos encontrar un punto com√∫n." }
  ]
};

// ===== ESTADO =====
var COOLDOWN = 60 * 60 * 1000;
var CREDITS_KEY = 'pm_v3_credits';
var TIME_KEY = 'pm_v3_time';
var MAX = 2;
var credits = MAX;
var cooldownEnd = null;
var selectedCtx = 'pareja';
var timerInterval = null;
var ridx = { pareja:0, cita:0, trabajo:0, negociacion:0 };

function loadState() {
  var savedTime = localStorage.getItem(TIME_KEY);
  var savedC = localStorage.getItem(CREDITS_KEY);
  if (savedTime) {
    var end = parseInt(savedTime, 10);
    if (Date.now() < end) {
      cooldownEnd = end; credits = 0;
    } else {
      credits = MAX;
      localStorage.removeItem(TIME_KEY);
      localStorage.setItem(CREDITS_KEY, String(MAX));
    }
  } else if (savedC !== null) {
    credits = parseInt(savedC, 10);
    if (isNaN(credits) || credits < 0) credits = MAX;
  }
  updateCreditDisplay();
}

function updateCreditDisplay() {
  document.getElementById('credit-display').textContent = credits;
}

function saveCredits() {
  localStorage.setItem(CREDITS_KEY, String(credits));
}

// ===== VISTA =====
var sections = ['input-section','loader-section','result-section','cooldown-section'];
function showSection(id) {
  sections.forEach(function(s) {
    var el = document.getElementById(s);
    el.className = s === id ? 'section visible' : 'section';
  });
  updateCreditDisplay();
}

// Contexto
document.getElementById('ctx-row').addEventListener('click', function(e) {
  var btn = e.target.closest('.ctx-btn');
  if (!btn) return;
  document.querySelectorAll('.ctx-btn').forEach(function(b){ b.classList.remove('active'); });
  btn.classList.add('active');
  selectedCtx = btn.dataset.ctx;
});

// ===== AN√ÅLISIS =====
function getResponse(ctx) {
  var pool = RESPONSES[ctx] || RESPONSES.cita;
  var idx = ridx[ctx] % pool.length;
  ridx[ctx]++;
  return pool[idx];
}

document.getElementById('btn-analyze').addEventListener('click', function() {
  var input = document.getElementById('chat-input').value.trim();
  if (input.length < 10) {
    alert('Escribe al menos 10 caracteres para analizar.');
    return;
  }
  if (credits <= 0) {
    if (cooldownEnd && Date.now() < cooldownEnd) {
      showSection('cooldown-section');
      startTimer();
      return;
    } else {
      credits = MAX; cooldownEnd = null;
      localStorage.removeItem(TIME_KEY);
      saveCredits();
    }
  }
  showSection('loader-section');
  var delay = 1400 + Math.random() * 800;
  setTimeout(function() {
    var d = getResponse(selectedCtx);
    document.getElementById('res-intention').textContent = d.intention;
    document.getElementById('res-interest').textContent = d.interest + '%';
    var rEl = document.getElementById('res-risk');
    rEl.textContent = d.risk;
    rEl.className = 'metric-value ' + d.riskCol;
    document.getElementById('res-action').textContent = '"' + d.action + '"';
    document.getElementById('res-msg').textContent = d.msg;
    credits--;
    saveCredits();
    if (credits <= 0) {
      var end = Date.now() + COOLDOWN;
      cooldownEnd = end;
      localStorage.setItem(TIME_KEY, String(end));
    }
    showSection('result-section');
  }, delay);
});

// Volver
document.getElementById('btn-back').addEventListener('click', function() {
  showSection('input-section');
});

// Copiar
document.getElementById('btn-copy').addEventListener('click', function() {
  var msg = document.getElementById('res-msg').textContent;
  var ta = document.createElement('textarea');
  ta.value = msg;
  ta.style.cssText = 'position:fixed;left:-9999px;top:0';
  document.body.appendChild(ta);
  ta.focus(); ta.select();
  try { document.execCommand('copy'); } catch(e) {}
  document.body.removeChild(ta);
  var btn = this;
  var orig = btn.innerHTML;
  btn.innerHTML = '‚úÖ COPIADO';
  setTimeout(function(){ btn.innerHTML = orig; }, 2000);
});

// CTA Links
var links = {
  'cta-wa1':'https://wa.me/34672680535?text=Hola%20Antonio%2C%20he%20probado%20ChatOps%20y%20quiero%20saber%20m√°s',
  'cta-wa2':'https://wa.me/34672680535?text=Hola%20Antonio%2C%20he%20probado%20ChatOps%20y%20quiero%20saber%20m√°s',
  'cta-mail1':'mailto:preemptivemovement@gmail.com?subject=Asesor√≠a%20ChatOps',
  'cta-mail2':'mailto:preemptivemovement@gmail.com?subject=Asesor√≠a%20ChatOps',
  'cta-blog1':'https://preemptivemovement.blogspot.com',
  'cta-blog2':'https://preemptivemovement.blogspot.com'
};
Object.keys(links).forEach(function(id) {
  var el = document.getElementById(id);
  if (el) el.addEventListener('click', function(){ window.open(links[id]); });
});

// ===== TIMER =====
function startTimer() {
  if (timerInterval) clearInterval(timerInterval);
  updateTimer();
  timerInterval = setInterval(function() {
    if (!cooldownEnd || Date.now() >= cooldownEnd) {
      clearInterval(timerInterval);
      credits = MAX; cooldownEnd = null;
      localStorage.removeItem(TIME_KEY);
      saveCredits();
      showSection('input-section');
    } else {
      updateTimer();
    }
  }, 1000);
}

function updateTimer() {
  var rem = cooldownEnd ? Math.max(0, cooldownEnd - Date.now()) : 0;
  var m = Math.floor(rem / 60000);
  var s = Math.floor((rem % 60000) / 1000);
  var el = document.getElementById('timer-display');
  if (el) el.textContent = m + ':' + (s < 10 ? '0' : '') + s;
}

// ===== INIT =====
loadState();
if (credits <= 0 && cooldownEnd && Date.now() < cooldownEnd) {
  showSection('cooldown-section');
  startTimer();
}

})();
</script>
</body>
</html>
